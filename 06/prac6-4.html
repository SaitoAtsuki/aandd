<!DOCTYPE html>

<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <script type="text/javascript" src="../aandd.js"></script>
    <script type="text/javascript" src="../jquery.min.js"></script>

    <script type="text/javascript" src="nouns.js"></script>
    <script type="text/javascript" src="verbs.js"></script>

    <script>

        var nouns;
        var verbs;

        $(document).ready(function () {
            nouns = nounstext.split('\n');
            verbs = verbstext.split('\n');
        });

        function runButtonPressed() {
            for (var j = 0; j < 1000000; j++) {
                var noun = selectone(nouns);
                var verb = selectone(verbs)
                // show(noun);
                // show(verb);
                html = '';
                html = html + noun + "は" + verb;
                var stack = reverse(html);
                if (html == stack) {
                    document.getElementById("res").innerHTML = html;
                    window.alert("ok;" + j + "回目");
                    break;
                }
                html = '';
            }
            if (html == '') window.alert("not found");
        }

        function selectone(array) {
            var size = array.length;
            var index = Math.floor(Math.random() * size);
            return array[index];
        }

        function show(array) {
            var html = '';
            html = html + '<table border="1">';
            html = html + '<tr>';
            for (var i = 0; i < array.length; i++) {
                html = html + '<td>' + array[i] + '</td>';
            }
            html = html + '</tr>';
            html = html + '</table>';
            //document.getElementById('res').innerHTML = html;
            document.getElementById('res').insertAdjacentHTML('beforeend', html);
        }

        function reverse(text) {
            var chars = text.split('');
            //console.log(chars);
            var stack = [];
            var n = chars.length;
            for (var i = 0; i < n; i++) {
                var word = chars.pop(i);
                stack.push(word);
            }
            //console.log(stack);
            var text2 = stack.join('');
            return text2;
        }

    </script>

</head>

<body>
    <h1>回文作文さん</h1>
    <button onclick="runButtonPressed()">run!</button>
    <p id="res"></p>

</body>

</html>